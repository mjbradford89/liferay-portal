YUI.add("toolbar-base",function(t){"use strict";function e(){}var n=t.Lang,i=t.Array,o=37,s=39,r=/\r?\n/;e.prototype={initializer:function(){var e,o=this;e=o.get("editor"),o._editorNode=t.one(e.element.$),i.each(o.get("buttons"),function(e){var i,s,r;i=n.isObject(e)?e.name:e,r=o._getButtonInstanceName(i),s=n.isObject(e)?e.cfg:null,o.plug(t[r],s),o[t[r].NS].after("actionPerformed",o._afterActionPerformed,o)}),o.after("render",o._afterRender,o),o.after("visibleChange",o._afterVisibleChange,o),e.on("editorInteraction",o._onEditorInteraction,o)},blur:function(){this.get("editor").focus()},focus:function(){var t,e;return t=this.get("buttonsContainer"),e=this.get("visible"),e&&t.focusManager.focus(0),e},ownsNode:function(t){return this.get("boundingBox").contains(t)},_afterRender:function(){var e=this.get("buttonsContainer");e.plug(t.Plugin.NodeFocusManager,{activeDescendant:0,circular:!0,descendants:"button",focusClass:"focus",keys:{next:"down:"+s,previous:"down:"+o}}),e.on("keydown",this._onKeyDown,this)},_afterVisibleChange:function(t){var e=this.get("strings");this.get("editor").fire("ariaUpdate",{message:n.sub(e.state,{focus:t.newVal?e.focus:"",name:this.name,state:t.newVal?e.visible:e.hidden})})},_applyTransition:function(e,n){var i,o,s,r,a,u,c;r=this.get("transition"),i=this.get("boundingBox"),i.setStyle("visibility","hidden"),o=i.getDOMNode(),s=o.offsetHeight,u=o.offsetWidth,n===CKEDITOR.SELECTION_TOP_TO_BOTTOM||n===CKEDITOR.SELECTION_BOTTOM_TO_TOP?(a=e[0],c=n===CKEDITOR.SELECTION_TOP_TO_BOTTOM?e[1]-s:e[1]+s):(n===CKEDITOR.SELECTION_LEFT_TO_RIGHT||n===CKEDITOR.SELECTION_RIGHT_TO_LEFT)&&(a=n===CKEDITOR.SELECTION_LEFT_TO_RIGHT?e[0]-u:e[0]+u,c=e[1]),this.set("xy",[a,c]),r.left=e[0]+"px",r.top=e[1]+"px",i.setStyle("visibility","visible"),i.transition(r),this.set("xy",e,{src:t.Widget.UI_SRC})},_afterActionPerformed:function(t){this.fire("actionPerformed",t)},_getButtonsContainer:function(){return this._buttonsContainer},_getButtonInstanceName:function(t){return"Button"+t.substring(0,1).toUpperCase()+t.substring(1)},_isCurrentLineEmpty:function(){var t;return t=this.get("editor").getSelection().getRanges()[0].getCommonAncestor(),r.test(t.getText())},_moveToPoint:function(t,e,n){var i;i=this.get("transition"),!i||n&&n.visible?this.set("xy",t):this._applyTransition(t,e)},_onKeyDown:function(t){this.get("editor").fire("toolbarKey",t)}},e.ATTRS={buttonsContainer:{getter:"_getButtonsContainer",readOnly:!0},editor:{validator:n.isObject},strings:{validator:n.isObject,value:{focus:"Press Alt + F10 to focus on the toolbar.",hidden:"hidden",state:"Toolbar {name} is now {state}. {focus}",visible:"visible"}},transition:{value:{easing:"ease-out",duration:.1}}},t.ToolbarBase=e},"",{requires:["node-focusmanager","node-base","plugin"]});