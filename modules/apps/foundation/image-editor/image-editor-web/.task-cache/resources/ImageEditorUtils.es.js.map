{"version":3,"sources":["/source/ImageEditorUtils.es.js"],"names":[],"mappings":"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","sourcesContent":["import { CancellablePromise } from 'metal-promise/src/promise/Promise';\n\n/**\n * ImageEditorUtils\n */\nclass ImageEditorUtils {\n\t/**\n\t * Constructor\n\t *\n\t * @param  {[type]} image       [description]\n\t * @param  {[type]} imageEditor [description]\n\t */\n\tconstructor(imageURL, element) {\n\t\tthis.element_ = element;\n\t\tthis.imageURL_ = imageURL;\n\t\tthis.imageDOMNode_ = this.element_.querySelector('.lfr-image-editor-image-container img');\n\t\tthis.previewCanvas_ = this.element_.querySelector('.lfr-image-editor-image-container canvas.image-preview');\n\n\t\tthis.rawImageDataPromise_ = new CancellablePromise((resolve, reject) => {\n\t\t\tlet bufferImage = new Image();\n\n\t\t\tbufferImage.onload = () => {\n\t\t\t\tlet bufferCanvas = document.createElement('canvas');\n\t            let bufferContext = bufferCanvas.getContext('2d');\n\n\t            let rawImageWidth = bufferImage.width;\n\t            let rawImageHeight = bufferImage.height;\n\n\t\t\t\tbufferCanvas.width = rawImageWidth;\n\t\t\t\tbufferCanvas.height = rawImageHeight;\n\n\t\t\t\tbufferContext.drawImage(bufferImage, 0, 0, rawImageWidth, rawImageHeight);\n\n\t\t\t\tlet rawImageData = bufferContext.getImageData(0, 0, rawImageWidth, rawImageHeight);\n\n\t\t\t\tresolve(rawImageData);\n\t\t\t};\n\n\t\t\tbufferImage.src = imageURL;\n\t\t});\n\t}\n\n\tenablePreview() {\n\t\tlet previewContext = this.previewCanvas_.getContext('2d');\n\n\t\tthis.previewCanvas_.height = this.imageDOMNode_.height;\n\t\tthis.previewCanvas_.width = this.imageDOMNode_.width;\n\n\t\tpreviewContext.drawImage(this.imageDOMNode_, 0, 0, this.previewCanvas_.width, this.previewCanvas_.height);\n\n\t\tthis.previewImageData_ = previewContext.getImageData(0, 0, this.previewCanvas_.width, this.previewCanvas_.height);\n\t}\n\n\t/**\n\t * [getImageData description]\n\t *\n\t * @return {CancellablePromise} [description]\n\t */\n\tgetImageData() {\n\t\treturn new CancellablePromise((resolve, reject) => {\n\t\t\tthis.rawImageDataPromise_.then((rawImageData) => {\n\t\t\t\tresolve({\n\t\t\t\t\tpreview: this.previewImageData_,\n\t\t\t\t\traw: rawImageData,\n\t\t\t\t\ttoURL: this.imageData2DataURL_,\n\t\t\t\t\turl: this.imageURL_\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\treturn this.imageDataPromise_;\n\t}\n\n\t/**\n\t * [renderPreview description]\n\t * @param  {[type]} imageData [description]\n\t * @return {[type]}           [description]\n\t */\n\tpreview(imageData) {\n\t\tlet previewContext = this.previewCanvas_.getContext('2d');\n\n\t\tpreviewContext.putImageData(imageData, 0, 0);\n\t}\n\n\timageData2DataURL_(imageData) {\n        let canvas = document.createElement('canvas');\n        canvas.width = imageData.width;\n        canvas.height = imageData.height;\n\n        let ctx = canvas.getContext('2d');\n        ctx.putImageData(imageData, 0, 0);\n\n        return canvas.toDataURL();\n\t}\n}\n\nexport default ImageEditorUtils;"]}