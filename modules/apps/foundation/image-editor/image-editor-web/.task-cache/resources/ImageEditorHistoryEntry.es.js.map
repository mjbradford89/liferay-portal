{"version":3,"sources":["/source/ImageEditorHistoryEntry.es.js"],"names":[],"mappings":";;;;;;;;;;;;;KAKM;;;;;AAIL,WAJK,uBAIL,CAAY,KAAZ,EAAmB;;;yBAJd,yBAIc;;AAClB,QAAK,YAAL,GAAoB,gCAAuB,UAAC,OAAD,EAAU,MAAV,EAAqB;AAC/D,QAAI,MAAM,GAAN,IAAa,CAAC,MAAM,IAAN,EAAY;AAC7B,WAAK,SAAL,CAAe,MAAM,GAAN,CAAf,CACE,IADF,CACO,UAAC,SAAD;aAAe,QAAQ,SAAR;MAAf,CADP,CAD6B;KAA9B,MAIK;AACJ,aAAQ,MAAM,IAAN,CAAR,CADI;KAJL;IAD0C,CAA3C,CADkB;GAAnB;;;;;;;;;AAJK,oCAqBL,+BAAU,UAAU;AACnB,UAAO,gCAAuB,UAAC,OAAD,EAAU,MAAV,EAAqB;AAClD,QAAI,cAAc,IAAI,KAAJ,EAAd,CAD8C;;AAGlD,gBAAY,MAAZ,GAAqB,YAAM;AAC1B,SAAI,eAAe,SAAS,aAAT,CAAuB,QAAvB,CAAf,CADsB;AAEjB,SAAI,gBAAgB,aAAa,UAAb,CAAwB,IAAxB,CAAhB,CAFa;;AAIjB,SAAI,SAAS,YAAY,MAAZ,CAJI;AAKjB,SAAI,QAAQ,YAAY,KAAZ,CALK;;AAO1B,kBAAa,KAAb,GAAqB,KAArB,CAP0B;AAQ1B,kBAAa,MAAb,GAAsB,MAAtB,CAR0B;;AAU1B,mBAAc,SAAd,CAAwB,WAAxB,EAAqC,CAArC,EAAwC,CAAxC,EAA2C,KAA3C,EAAkD,MAAlD,EAV0B;;AAY1B,aAAQ,cAAc,YAAd,CAA2B,CAA3B,EAA8B,CAA9B,EAAiC,KAAjC,EAAwC,MAAxC,CAAR,EAZ0B;KAAN,CAH6B;;AAkBlD,gBAAY,GAAZ,GAAkB,QAAlB,CAlBkD;IAArB,CAA9B,CADmB;;;AArBf,oCAiDL,uCAAe;AACd,UAAO,KAAK,YAAL,CADO;;;SAjDV;;;mBAsDS","sourcesContent":["import { CancellablePromise } from 'metal-promise/src/promise/Promise';\n\n/**\n * Image Editor History Entry\n */\nclass ImageEditorHistoryEntry {\n\t/**\n\t * Constructor\n\t */\n\tconstructor(image) {\n\t\tthis.dataPromise_ = new CancellablePromise((resolve, reject) => {\n\t\t\tif (image.url && !image.data) {\n\t\t\t\tthis.loadData_(image.url)\n\t\t\t\t\t.then((imageData) => resolve(imageData));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tresolve(image.data);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * [loadData_ description]\n\t * @param  {[type]} imageURL [description]\n\t * @return {[type]}          [description]\n\t */\n\tloadData_(imageURL) {\n\t\treturn new CancellablePromise((resolve, reject) => {\n\t\t\tlet bufferImage = new Image();\n\n\t\t\tbufferImage.onload = () => {\n\t\t\t\tlet bufferCanvas = document.createElement('canvas');\n\t            let bufferContext = bufferCanvas.getContext('2d');\n\n\t            let height = bufferImage.height;\n\t            let width = bufferImage.width;\n\n\t\t\t\tbufferCanvas.width = width;\n\t\t\t\tbufferCanvas.height = height;\n\n\t\t\t\tbufferContext.drawImage(bufferImage, 0, 0, width, height);\n\n\t\t\t\tresolve(bufferContext.getImageData(0, 0, width, height));\n\t\t\t};\n\n\t\t\tbufferImage.src = imageURL;\n\t\t});\n\t}\n\n\t/**\n\t * [getImageData description]\n\t *\n\t * @return {CancellablePromise} [description]\n\t */\n\tgetImageData() {\n\t\treturn this.dataPromise_;\n\t}\n}\n\nexport default ImageEditorHistoryEntry;"]}